{% extends 'base.html' %}

{% block title %}{{ type_display }} - –ò—Å—Ç–æ—Ä–∏—è{% endblock %}

{% block extra_css %}
<style>
    .header-section {
        background: {% if transaction_type == 'income' %}linear-gradient(135deg, #11998e 0%, #38ef7d 100%){% else %}linear-gradient(135deg, #ee0979 0%, #ff6a00 100%){% endif %};
        color: #fff;
        padding: 30px;
        border-radius: 16px;
        margin-bottom: 30px;
    }

    .header-section h1 {
        font-size: 32px;
        margin-bottom: 10px;
    }

    .total-amount {
        font-size: 48px;
        font-weight: bold;
        margin: 15px 0;
    }

    .back-link {
        color: rgba(255,255,255,0.8);
        text-decoration: none;
        display: inline-block;
        margin-bottom: 15px;
        transition: color 0.3s;
    }

    .back-link:hover {
        color: #fff;
    }

    .transaction-list {
        background: #fff;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .transaction-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid #f0f0f0;
        transition: background 0.3s;
    }

    .transaction-item:hover {
        background: #f9f9f9;
    }

    .transaction-item:last-child {
        border-bottom: none;
    }

    .transaction-icon {
        font-size: 32px;
        margin-right: 15px;
    }

    .transaction-details {
        flex: 1;
    }

    .transaction-category {
        font-size: 18px;
        font-weight: 600;
        color: #333;
        margin-bottom: 5px;
    }

    .transaction-meta {
        font-size: 13px;
        color: #999;
        display: flex;
        gap: 15px;
        align-items: center;
    }

    .transaction-wallet {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        padding: 3px 10px;
        background: #e3f2fd;
        border-radius: 12px;
        color: #1976d2;
        font-size: 12px;
    }

    .transaction-amount {
        font-size: 24px;
        font-weight: bold;
        color: {% if transaction_type == 'income' %}#4CAF50{% else %}#f44336{% endif %};
        margin-right: 15px;
    }

    .transaction-actions {
        display: flex;
        gap: 10px;
    }

    .btn-icon {
        padding: 8px 12px;
        background: #f5f5f5;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
        text-decoration: none;
        color: #666;
        font-size: 14px;
    }

    .btn-icon:hover {
        background: #e0e0e0;
        color: #333;
    }

    .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #999;
    }

    .empty-state-icon {
        font-size: 72px;
        margin-bottom: 20px;
    }

    @media (max-width: 768px) {
        .transaction-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 15px;
        }

        .transaction-amount {
            font-size: 20px;
        }

        .transaction-actions {
            width: 100%;
            justify-content: flex-end;
        }

        .header-section h1 {
            font-size: 24px;
        }

        .total-amount {
            font-size: 36px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="header-section">
    <a href="{% url 'dashboard' %}" class="back-link">‚Üê –ù–∞–∑–∞–¥</a>
    <h1>{% if transaction_type == 'income' %}üìà –î–æ—Ö–æ–¥—ã{% else %}üìâ –†–∞—Å—Ö–æ–¥—ã{% endif %}</h1>
    <div class="total-amount">
        {% if transaction_type == 'outcome' %}-{% else %}+{% endif %}{{ total|floatformat:0 }} —Å—É–º
    </div>
    <div style="opacity: 0.9; font-size: 14px;">
        –í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: {{ transactions|length }}
    </div>
</div>



<div class="transaction-list">
    {% for transaction in transactions %}
        <div class="transaction-item">
            <div class="transaction-icon">
                {% if transaction.category %}üí∞{% else %}üí∞{% endif %}
            </div>
            
            <div class="transaction-details">
                <div class="transaction-category">
                    {{ transaction.category.name|default:"–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏" }}
                </div>
                <div class="transaction-meta">
                    <span>{{ transaction.created_at|date:"d.m.Y H:i" }}</span>
                    <span class="transaction-wallet">
                        {% if transaction.wallet.type == 'cash' %}üíµ
                        {% elif transaction.wallet.type == 'uzcard' %}üí≥
                        {% elif transaction.wallet.type == 'visa' %}üíé
                        {% endif %}
                        {{ transaction.wallet.name }}
                    </span>
                </div>
                {% if transaction.description %}
                    <div style="margin-top: 8px; color: #666; font-size: 14px;">
                        {{ transaction.description }}
                    </div>
                {% endif %}
            </div>
            
            <div class="transaction-amount">
                {% if transaction.type == 'outcome' %}-{% else %}+{% endif %}
                {{ transaction.amount|floatformat:0 }}
            </div>
            
            <div class="transaction-actions">
                <form method="post" action="{% url 'transaction_delete' transaction.pk %}" style="display: inline;" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é?');">
                    {% csrf_token %}
                    <button type="submit" class="btn-icon" style="color: #f44336;">üóëÔ∏è</button>
                </form>
            </div>
        </div>
    {% empty %}
        <div class="empty-state">
            <div class="empty-state-icon">
                {% if transaction_type == 'income' %}üìà{% else %}üìâ{% endif %}
            </div>
            <h3>–ü–æ–∫–∞ –Ω–µ—Ç {{ type_display|lower }}</h3>
            <p style="margin: 15px 0;">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é</p>
            <a href="{% url 'manage_money' %}" class="btn">+ –î–æ–±–∞–≤–∏—Ç—å</a>
        </div>
    {% endfor %}
</div>

{% if is_paginated %}
    <div style="display: flex; justify-content: center; gap: 10px; margin-top: 30px;">
        {% if page_obj.has_previous %}
            <a href="?page=1" class="btn btn-small btn-secondary">–ü–µ—Ä–≤–∞—è</a>
            <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-small btn-secondary">‚Üê –ù–∞–∑–∞–¥</a>
        {% endif %}

        <span style="padding: 8px 16px; background: #f5f5f5; border-radius: 6px;">
            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" class="btn btn-small btn-secondary">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
            <a href="?page={{ page_obj.paginator.num_pages }}" class="btn btn-small btn-secondary">–ü–æ—Å–ª–µ–¥–Ω—è—è</a>
        {% endif %}
    </div>
{% endif %}
{% endblock %}