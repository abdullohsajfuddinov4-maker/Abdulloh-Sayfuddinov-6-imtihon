{% extends 'main/base.html' %}

{% block title %}{{ wallet.name }} - –î–µ—Ç–∞–ª–∏ –∫–æ—à–µ–ª—å–∫–∞{% endblock %}

{% block extra_css %}
<style>
    .wallet-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #fff;
        padding: 40px 30px;
        border-radius: 16px;
        margin-bottom: 30px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .wallet-header.cash {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }

    .wallet-header.uzcard {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .wallet-header.visa {
        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }

    .back-button {
        color: rgba(255,255,255,0.8);
        text-decoration: none;
        display: inline-block;
        margin-bottom: 20px;
        transition: color 0.3s;
    }

    .back-button:hover {
        color: #fff;
    }

    .wallet-info {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        flex-wrap: wrap;
        gap: 20px;
    }

    .wallet-name-section h1 {
        font-size: 36px;
        margin-bottom: 10px;
    }

    .wallet-type-badge {
        display: inline-block;
        padding: 6px 16px;
        background: rgba(255,255,255,0.2);
        border-radius: 20px;
        font-size: 14px;
        margin-bottom: 15px;
    }

    .wallet-balance-section {
        text-align: right;
    }

    .wallet-balance {
        font-size: 48px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .wallet-currency {
        opacity: 0.9;
        font-size: 16px;
    }

    .action-buttons {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .action-buttons .btn {
        flex: 1;
        min-width: 150px;
    }

    .transactions-section {
        background: #fff;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
    }

    .section-header h2 {
        color: #333;
        font-size: 22px;
    }

    .transaction-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid #f5f5f5;
        transition: background 0.3s;
    }

    .transaction-item:hover {
        background: #f9f9f9;
    }

    .transaction-item:last-child {
        border-bottom: none;
    }

    .transaction-icon {
        font-size: 32px;
        margin-right: 15px;
    }

    .transaction-info {
        flex: 1;
    }

    .transaction-category {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        margin-bottom: 4px;
    }

    .transaction-date {
        font-size: 13px;
        color: #999;
    }

    .transaction-description {
        font-size: 13px;
        color: #666;
        margin-top: 5px;
    }

    .transaction-amount {
        font-size: 20px;
        font-weight: bold;
    }

    .transaction-amount.income {
        color: #4CAF50;
    }

    .transaction-amount.outcome {
        color: #f44336;
    }

    .empty-transactions {
        text-align: center;
        padding: 60px 20px;
        color: #999;
    }

    .empty-transactions-icon {
        font-size: 72px;
        margin-bottom: 20px;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 30px;
    }

    .stat-box {
        background: #fff;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .stat-label {
        font-size: 14px;
        color: #999;
        margin-bottom: 8px;
    }

    .stat-value {
        font-size: 28px;
        font-weight: bold;
        color: #333;
    }

    .stat-value.positive {
        color: #4CAF50;
    }

    .stat-value.negative {
        color: #f44336;
    }

    @media (max-width: 768px) {
        .wallet-info {
            flex-direction: column;
        }

        .wallet-balance-section {
            text-align: left;
        }

        .wallet-name-section h1 {
            font-size: 28px;
        }

        .wallet-balance {
            font-size: 36px;
        }

        .action-buttons {
            flex-direction: column;
        }

        .action-buttons .btn {
            width: 100%;
        }

        .transaction-item {
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="wallet-header {{ wallet.type }}">
    <a href="{% url 'wallet_list' %}" class="back-button">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–æ—à–µ–ª—å–∫–∞–º</a>

    <div class="wallet-info">
        <div class="wallet-name-section">
            <span class="wallet-type-badge">
                {% if wallet.type == 'cash' %}
                    üíµ –ù–∞–ª–∏—á–Ω—ã–µ
                {% elif wallet.type == 'uzcard' %}
                    üí≥ UzCard
                {% elif wallet.type == 'visa' %}
                    üíé Visa
                {% endif %}
            </span>
            <h1>{{ wallet.name }}</h1>
            <div style="opacity: 0.9; font-size: 14px;">
                –°–æ–∑–¥–∞–Ω: {{ wallet.created_at|date:"d F Y" }}
            </div>
        </div>

        <div class="wallet-balance-section">
            <div class="wallet-balance">
                {{ wallet.balance|default:0|floatformat:0 }}
            </div>
            <div class="wallet-currency">
                {% if wallet.currency == 'UZS' %}
                    –£–∑–±–µ–∫—Å–∫–∏–π —Å—É–º
                {% else %}
                    –î–æ–ª–ª–∞—Ä –°–®–ê
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
<div class="action-buttons">
    <a href="{% url 'transaction_create' wallet.pk %}" class="btn">
        üí∏ –ü–æ–ø–æ–ª–Ω–∏—Ç—å / –°–Ω—è—Ç—å
    </a>
</div>

<!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="stats-grid">

    <div class="stat-box">
        <div class="stat-label">üìä –í—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
        <div class="stat-value">
            {{ transactions|length|default:0 }}
        </div>
    </div>

    <div class="stat-box">
        <div class="stat-label">üìà –î–æ—Ö–æ–¥–æ–≤</div>
        <div class="stat-value positive">
            +{{ income|default:0|floatformat:0 }}
        </div>
    </div>

    <div class="stat-box">
        <div class="stat-label">üìâ –†–∞—Å—Ö–æ–¥–æ–≤</div>
        <div class="stat-value negative">
            -{{ outcome|default:0|floatformat:0 }}
        </div>
    </div>

</div>

<!-- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ -->
<div class="transactions-section">
    <div class="section-header">
        <h2>üïí –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
    </div>

    {% if transactions and transactions|length > 0 %}
        {% for transaction in transactions %}
            <div class="transaction-item">

                <div class="transaction-icon">
                    {% if transaction.category and transaction.category.icon %}
                        {{ transaction.category.icon }}
                    {% else %}
                        üí∞
                    {% endif %}
                </div>

                <div class="transaction-info">
                    <div class="transaction-category">
                        {% if transaction.category %}
                            {{ transaction.category.name }}
                        {% else %}
                            –ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                        {% endif %}
                    </div>

                    <div class="transaction-date">
                        {{ transaction.created_at|date:"d.m.Y H:i" }}
                    </div>

                    {% if transaction.description %}
                        <div class="transaction-description">
                            {{ transaction.description }}
                        </div>
                    {% endif %}
                </div>

                <div class="transaction-amount {{ transaction.type }}">
                    {% if transaction.type == 'income' %}+{% else %}-{% endif %}
                    {{ transaction.amount|default:0|floatformat:0 }}
                </div>

            </div>
        {% endfor %}
    {% else %}
        <div class="empty-transactions">
            <div class="empty-transactions-icon">üì≠</div>
            <h3>–ü–æ–∫–∞ –Ω–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h3>
            <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –¥–ª—è —ç—Ç–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞</p>
        </div>
    {% endif %}
</div>
{% endblock %}
